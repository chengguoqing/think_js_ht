{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\controller\\comm\\qianming.js"
    ],
    "names": [
        "Base",
        "require",
        "request",
        "md5",
        "xml2js",
        "module",
        "exports",
        "indexAction",
        "date_s",
        "ctx",
        "post",
        "JSON",
        "parse",
        "decryption",
        "token",
        "sd_drr",
        "get_qianm",
        "openid",
        "jiner",
        "sd_ddf",
        "code",
        "msg",
        "data",
        "encryption",
        "stringify",
        "fail",
        "sd_sdf",
        "timeStamp",
        "String",
        "Date",
        "getTime",
        "th",
        "appid",
        "mch_id",
        "body",
        "nonce_str",
        "randomString",
        "out_trade_no",
        "total_fee",
        "spbill_create_ip",
        "trade_type",
        "notify_url",
        "stringA",
        "Object",
        "keys",
        "s_sdfs",
        "sort",
        "map",
        "a",
        "substring",
        "length",
        "stringSignTemp",
        "s",
        "toUpperCase",
        "sign",
        "Promise",
        "resolve",
        "reject",
        "url",
        "method",
        "buildXML",
        "err",
        "response",
        "parseString",
        "explicitArray",
        "json",
        "console",
        "log",
        "sd_das",
        "xml",
        "sd_drtsae",
        "appId",
        "nonceStr",
        "package",
        "prepay_id",
        "signType",
        "key",
        "paySign",
        "zx"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\controller\\comm\\qianming.js",
    "sourcesContent": [
        "const Base = require('../base_nb.js');\r\nvar request = require('request');\r\nvar md5 = require('md5');\r\nvar xml2js = require('xml2js');\r\n//微信支付的签名 \r\nmodule.exports = class extends Base {\r\n    async indexAction() {\r\n        var date_s = this.ctx.post()\r\n        date_s = JSON.parse(this.decryption(date_s.token))\r\n        var sd_drr = await this.get_qianm(date_s.openid, date_s.jiner)\r\n\r\n        var sd_ddf = {}\r\n        sd_ddf.code = 0\r\n        sd_ddf.msg = \"success\"\r\n        sd_ddf.data = this.encryption(JSON.stringify(sd_drr))\r\n\r\n        return this.fail(sd_ddf); //2输出json 推荐\r\n\r\n    }\r\n\r\n    get_qianm(openid, jiner) {\r\n        var sd_sdf = {},\r\n            timeStamp = String(new Date().getTime()),\r\n            th = this\r\n        sd_sdf.appid = \"wx30f2eb708506f491\"\r\n        sd_sdf.mch_id = \"1491259172\"\r\n        sd_sdf.body = \"独行工匠\"\r\n        sd_sdf.timeStamp = timeStamp\r\n        sd_sdf.nonce_str = this.randomString()\r\n        sd_sdf.out_trade_no = new Date().getTime()\r\n        sd_sdf.total_fee = jiner * 100\r\n        sd_sdf.spbill_create_ip = \"218.17.251.186\"\r\n        sd_sdf.trade_type = \"JSAPI\"\r\n        sd_sdf.notify_url = \"http://duxinggj.com/\"\r\n        sd_sdf.openid = openid\r\n        var stringA = Object.keys(sd_sdf),\r\n            s_sdfs = \"\"\r\n        stringA.sort()\r\n        stringA.map(function (a) {\r\n            s_sdfs += \"&\" + a + \"=\" + sd_sdf[a]\r\n        })\r\n        s_sdfs = s_sdfs.substring(1, s_sdfs.length)\r\n        var stringSignTemp = s_sdfs + \"&key=5E1B3F82F1D5CAA0C62DD42E6DAAACD4\" //key为商户平台设置的密钥key\r\n        var s = md5(stringSignTemp).toUpperCase()\r\n        sd_sdf.sign = s\r\n\r\n        return new Promise((resolve, reject) => {\r\n            request({\r\n                url: \"https://api.mch.weixin.qq.com/pay/unifiedorder\",\r\n                method: 'POST',\r\n                body: th.buildXML(sd_sdf)\r\n            }, function (err, response, body) {\r\n                xml2js.parseString(body, {\r\n                    explicitArray: false\r\n                }, function (err, json) {\r\n                    console.log(json);\r\n                    let sd_das = json.xml,\r\n                        sd_drtsae = {}\r\n                    sd_drtsae.appId = sd_das.appid;\r\n                    sd_drtsae.nonceStr = sd_das.nonce_str;\r\n                    sd_drtsae.package = \"prepay_id=\" + sd_das.prepay_id\r\n                    sd_drtsae.signType = \"MD5\"\r\n                    sd_drtsae.timeStamp = timeStamp;\r\n                    sd_drtsae.key = \"5E1B3F82F1D5CAA0C62DD42E6DAAACD4\"\r\n                    sd_drtsae.paySign = md5(th.zx(sd_drtsae))\r\n                    resolve(JSON.stringify(sd_drtsae))\r\n                });\r\n            });\r\n\r\n\r\n        })\r\n    }\r\n\r\n};\r\n"
    ]
}