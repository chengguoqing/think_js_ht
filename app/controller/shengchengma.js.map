{
    "version": 3,
    "sources": [
        "..\\..\\src\\controller\\shengchengma.js"
    ],
    "names": [
        "Base",
        "require",
        "request",
        "fs",
        "cache",
        "tengxun_sc",
        "module",
        "exports",
        "indexAction",
        "th",
        "sd_dse",
        "path",
        "url_e_er",
        "get",
        "getqc_ma",
        "js_sdf",
        "gettoken",
        "msg_d",
        "code",
        "msg",
        "data",
        "display",
        "Promise",
        "resolve",
        "reject",
        "wx_sdf",
        "wcf",
        "cache_duration",
        "url_sd",
        "appId",
        "secret",
        "error",
        "resp",
        "json",
        "JSON",
        "parse",
        "access_token",
        "put",
        "dekh",
        "file_name",
        "think",
        "uuid",
        "urk_dd",
        "sd_drer",
        "url",
        "method",
        "body",
        "stringify",
        "pipe",
        "createWriteStream",
        "sdsd_dse"
    ],
    "mappings": ";;AAAA,MAAMA,OAAOC,QAAQ,SAAR,CAAb;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;AACA,IAAIE,KAAKF,QAAQ,IAAR,CAAT;AACA,IAAIG,QAAQH,QAAQ,cAAR,CAAZ;AACA,MAAMI,aAAaJ,QAAQ,uBAAR,CAAnB;;AAEA;AACAK,OAAOC,OAAP,GAAiB,cAAcP,IAAd,CAAmB;AAC1BQ,eAAN,GAAoB;AAAA;;AAAA;;AAGhB,gBAAIC,UAAJ;;AAEA,gBAAIC,SAAS;AACTC,sBAAM;AADG,aAAb;AAGA,gBAAIC,WAAW,EAAf;AACA,gBAAIR,MAAMS,GAAN,CAAU,YAAV,CAAJ,EAA6B;AACzBD,2BAAW,MAAM,MAAKE,QAAL,CAAcJ,MAAd,EAAsBN,MAAMS,GAAN,CAAU,YAAV,CAAtB,CAAjB;AACH,aAFD,MAEO;AACH,oBAAIE,SAAS,MAAM,MAAKC,QAAL,EAAnB;AACAJ,2BAAW,MAAM,MAAKE,QAAL,CAAcJ,MAAd,EAAsBK,MAAtB,CAAjB;AACH;AACD,gBAAIE,QAAQ,EAAZ;AACAA,kBAAMC,IAAN,GAAa,CAAb;AACAD,kBAAME,GAAN,GAAY,MAAZ;AACAF,kBAAMG,IAAN,GAAaR,QAAb;AACG,mBAAO,MAAKS,OAAL,EAAP;;AAEX;;AArBwB;AAwBnB;;AAEDL,eAAW;AACP,eAAO,IAAIM,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,gBAAIC,SAAS,KAAKC,GAAL,EAAb;AACA,gBAAIC,iBAAiB,OAAO,EAAP,GAAY,EAAZ,GAAiB,CAAtC,CAFoC,CAEI;AACxC,gBAAIC,SAAS,gFAAgFH,OAAOI,KAAvF,GAA+F,UAA/F,GAA4GJ,OAAOK,MAAhI;AACA5B,oBAAQ0B,MAAR,EAAgB,UAAUG,KAAV,EAAiBC,IAAjB,EAAuBC,IAAvB,EAA6B;AACzCA,uBAAOC,KAAKC,KAAL,CAAWF,IAAX,EAAiBG,YAAxB;AACAhC,sBAAMiC,GAAN,CAAU,YAAV,EAAwBJ,IAAxB,EAA8BN,cAA9B;AACAJ,wBAAQU,IAAR;AACH,aAJD;AAKH,SATM,CAAP;AAWH;;AAEDnB,aAASwB,IAAT,EAAeF,YAAf,EAA6B;AACzB,eAAO,IAAId,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,gBAAII,SAAS,2DAA2DQ,YAAxE;AAAA,gBACIG,YAAYC,MAAMC,IAAN,KAAe,MAD/B;AAAA,gBAEIC,SAAS,mBAAmBH,SAFhC;AAGF,gBAAII,UAAUzC,QAAQ;AAChB0C,qBAAKhB,MADW;AAEhBiB,wBAAQ,MAFQ;AAGhBC,sBAAMZ,KAAKa,SAAL,CAAeT,IAAf;AAHU,aAAR,EAITU,IAJS,CAIJ7C,GAAG8C,iBAAH,CAAqB,SAAOP,MAA5B,CAJI,CAAd;AAKA,gBAAIQ,WAAS,EAAb;AACAA,qBAASX,SAAT,GAAmBA,SAAnB;AACAW,qBAASR,MAAT,GAAgBA,MAAhB;AACAnB,oBAAQ2B,QAAR;AAED,SAdM,CAAP;AAeH;AAzD+B,CAApC",
    "file": "..\\..\\src\\controller\\shengchengma.js",
    "sourcesContent": [
        "const Base = require('./pc.js');\r\nvar request = require('request');\r\nvar fs = require('fs');\r\nvar cache = require('memory-cache')\r\nconst tengxun_sc = require('../util/tengxun_sc.js');\r\n\r\n//生成小程序码\r\nmodule.exports = class extends Base {\r\n    async indexAction() {\r\n\r\n\r\n        var th = this\r\n\r\n        var sd_dse = {\r\n            path: \"/pages/xiangqing/main\"\r\n        }\r\n        var url_e_er = \"\"\r\n        if (cache.get('access_toe')) {\r\n            url_e_er = await this.getqc_ma(sd_dse, cache.get('access_toe'))\r\n        } else {\r\n            var js_sdf = await this.gettoken()\r\n            url_e_er = await this.getqc_ma(sd_dse, js_sdf)\r\n        }\r\n        var msg_d = {}\r\n        msg_d.code = 0\r\n        msg_d.msg = \"上传成功\"\r\n        msg_d.data = url_e_er\r\n           return this.display();\r\n        \r\n//        return this.fail(msg_d); //2输出json 推荐\r\n\r\n\r\n    }\r\n\r\n    gettoken() {\r\n        return new Promise((resolve, reject) => {\r\n            var wx_sdf = this.wcf()\r\n            var cache_duration = 1000 * 60 * 60 * 2 //缓存时长为2小时\r\n            var url_sd = \"https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=\" + wx_sdf.appId + \"&secret=\" + wx_sdf.secret\r\n            request(url_sd, function (error, resp, json) {\r\n                json = JSON.parse(json).access_token\r\n                cache.put('access_toe', json, cache_duration);\r\n                resolve(json)\r\n            })\r\n        })\r\n\r\n    }\r\n\r\n    getqc_ma(dekh, access_token) {\r\n        return new Promise((resolve, reject) => {\r\n            let url_sd = \"https://api.weixin.qq.com/wxa/getwxacode?access_token=\" + access_token,\r\n                file_name = think.uuid() + \".png\",\r\n                urk_dd = \"static/updata/\" + file_name\r\n          var sd_drer=  request({\r\n                url: url_sd,\r\n                method: 'post',\r\n                body: JSON.stringify(dekh)\r\n            }).pipe(fs.createWriteStream('www/'+urk_dd)) \r\n          let sdsd_dse={}\r\n          sdsd_dse.file_name=file_name\r\n          sdsd_dse.urk_dd=urk_dd\r\n          resolve(sdsd_dse)\r\n\r\n        })\r\n    }\r\n};\r\n"
    ]
}